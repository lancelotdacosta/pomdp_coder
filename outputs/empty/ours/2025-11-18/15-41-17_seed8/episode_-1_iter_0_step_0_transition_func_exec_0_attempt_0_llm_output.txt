```python
def transition_func(state, action):
    """
    Args:
        state (MinigridState): the state of the environment 
        action (int): action to be taken in state `state`
    Returns:
        new_state (MinigridState): the new state of the environment
    """
    
    def move_forward(agent_pos, agent_dir, grid):
        """Move the agent forward if the next cell is not a wall."""
        next_pos = np.array(agent_pos) + np.array(DIR_TO_VEC[agent_dir])
        
        # Check if the next position is within the grid and not a wall
        if 0 <= next_pos[0] < grid.shape[0] and 0 <= next_pos[1] < grid.shape[1]:
            if grid[next_pos[0], next_pos[1]] != ObjectTypes.wall:
                return tuple(next_pos)
        return agent_pos

    def turn(agent_dir, action):
        """Turn the agent left or right."""
        if action == Actions.left:
            return (agent_dir - 1) % 4
        elif action == Actions.right:
            return (agent_dir + 1) % 4
        return agent_dir

    # Initialize the new state with the current state
    new_state = MinigridState(
        grid=np.copy(state.grid),
        agent_pos=state.agent_pos,
        agent_dir=state.agent_dir,
        carrying=state.carrying
    )

    # Perform the action
    if action == Actions.forward:
        new_state.agent_pos = move_forward(new_state.agent_pos, new_state.agent_dir, new_state.grid)
    elif action in [Actions.left, Actions.right]:
        new_state.agent_dir = turn(new_state.agent_dir, action)
    elif action == Actions.pickup:
        front_pos = new_state.front_pos
        if 0 <= front_pos[0] < new_state.grid.shape[0] and 0 <= front_pos[1] < new_state.grid.shape[1]:
            obj_type = new_state.grid[front_pos[0], front_pos[1]]
            if obj_type in [ObjectTypes.key, ObjectTypes.ball, ObjectTypes.box]:
                new_state.carrying = obj_type
                new_state.grid[front_pos[0], front_pos[1]] = ObjectTypes.empty
    elif action == Actions.drop:
        if new_state.carrying is not None:
            front_pos = new_state.front_pos
            if 0 <= front_pos[0] < new_state.grid.shape[0] and 0 <= front_pos[1] < new_state.grid.shape[1]:
                new_state.grid[front_pos[0], front_pos[1]] = new_state.carrying
                new_state.carrying = None
    elif action == Actions.toggle:
        front_pos = new_state.front_pos
        if 0 <= front_pos[0] < new_state.grid.shape[0] and 0 <= front_pos[1] < new_state.grid.shape[1]:
            obj_type = new_state.grid[front_pos[0], front_pos[1]]
            if obj_type in [ObjectTypes.closed_door, ObjectTypes.open_door]:
                new_state.grid[front_pos[0], front_pos[1]] = ObjectTypes.open_door if obj_type == ObjectTypes.closed_door else ObjectTypes.closed_door

    return new_state
```