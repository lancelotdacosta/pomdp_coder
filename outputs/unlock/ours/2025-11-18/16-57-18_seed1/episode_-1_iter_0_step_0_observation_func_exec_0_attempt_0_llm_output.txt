```python
def observation_func(state, action, empty_obs):
    """
    Args:
        state (MinigridState): the state of the environment
        action (int): the previous action that was taken
        empty_obs (MinigridObservation): an empty observation that needs to be filled and returned
    Returns:
        obs (MinigridObservation): observation of the agent
    """

    def apply_action(state, action):
        """Apply the action to the state and return the new state."""
        new_state = MinigridState(
            grid=state.grid.copy(),
            agent_pos=state.agent_pos,
            agent_dir=state.agent_dir,
            carrying=state.carrying
        )
        
        if action == Actions.left:
            new_state.agent_dir = (new_state.agent_dir - 1) % 4
        elif action == Actions.right:
            new_state.agent_dir = (new_state.agent_dir + 1) % 4
        elif action == Actions.forward:
            new_pos = np.array(new_state.agent_pos) + DIR_TO_VEC[new_state.agent_dir]
            if 0 <= new_pos[0] < new_state.width and 0 <= new_pos[1] < new_state.height:
                if new_state.grid[new_pos[0], new_pos[1]] != ObjectTypes.wall:
                    new_state.agent_pos = new_pos.tolist()
        elif action == Actions.pickup:
            front_pos = new_state.front_pos
            if new_state.grid[front_pos[0], front_pos[1]] == ObjectTypes.key:
                new_state.carrying = ObjectTypes.key
                new_state.grid[front_pos[0], front_pos[1]] = ObjectTypes.empty
        elif action == Actions.drop:
            if new_state.carrying is not None:
                front_pos = new_state.front_pos
                if new_state.grid[front_pos[0], front_pos[1]] == ObjectTypes.empty:
                    new_state.grid[front_pos[0], front_pos[1]] = new_state.carrying
                    new_state.carrying = None
        elif action == Actions.toggle:
            front_pos = new_state.front_pos
            if new_state.grid[front_pos[0], front_pos[1]] == ObjectTypes.closed_door:
                new_state.grid[front_pos[0], front_pos[1]] = ObjectTypes.open_door
            elif new_state.grid[front_pos[0], front_pos[1]] == ObjectTypes.open_door:
                new_state.grid[front_pos[0], front_pos[1]] = ObjectTypes.closed_door
        return new_state

    # Apply the action to get the new state
    new_state = apply_action(state, action)

    # Get the field of view for the new state
    fov = new_state.get_field_of_view(view_size=3)

    # Update the empty observation with the new state and field of view
    empty_obs.agent_pos = new_state.agent_pos
    empty_obs.agent_dir = new_state.agent_dir
    empty_obs.carrying = new_state.carrying
    empty_obs.image = fov

    return empty_obs
```