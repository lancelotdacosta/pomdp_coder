```python
def reward_func(state, action, next_state):
    """
    Args:
        state (MinigridState): the state of the environment
        action (int): the action to be executed
        next_state (MinigridState): the next state of the environment
    Returns:
        reward (float): the reward of that state
        done (bool): whether the episode is done
    """
    
    def is_at_goal(pos, grid):
        """Check if the agent is at the goal position."""
        goal_positions = state.get_type_indices(ObjectTypes.goal)
        return pos in goal_positions

    def is_door_locked(pos, grid):
        """Check if the cell at position pos is a locked door."""
        return grid[pos[0], pos[1]] == ObjectTypes.locked_door

    def is_key_carried(state):
        """Check if the agent is carrying a key."""
        return state.carrying == ObjectTypes.key

    reward = 0
    done = False

    # Check if the agent has reached the goal
    if is_at_goal(next_state.agent_pos, next_state.grid):
        reward = 1
        done = True

    # Check if the agent tried to move through a locked door without a key
    front_pos = next_state.front_pos
    if is_door_locked(front_pos, state.grid) and not is_key_carried(state):
        reward = -1

    # Check if the agent picked up a key
    if action == Actions.pickup and state.grid[front_pos] == ObjectTypes.key:
        reward = 0.1

    # Check if the agent unlocked a door
    if action == Actions.toggle and state.grid[front_pos] == ObjectTypes.locked_door and is_key_carried(state):
        reward = 0.5

    return reward, done
```